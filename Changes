Revision history for Perl extension OpenInteract.

1.06  Sun Feb 25 15:16:43 EST 2001

 * OpenInteract/Package*: Split out previous OpenInteract/Package.pm
   into OpenInteract/PackageRepository.pm (SPOPS::HashFile object
   representing a package respository) and OpenInteract/Package.pm
   (class methods operating on simple hashrefs representing individual
   packages). In certain ways both are simpler and easier to
   understand, and this allows you to think of and work with a package
   repository as a single item rather than solely on individual packages.

   This has a couple of effects:

     1) GDBM is no longer used by OpenInteract. This was the primary
     motivator behind the change.

     2) You MUST modify all repositories from the old GDBM format to
     the new format. If you run the new 'upgrade' command from
     oi_manage when you download and install this distribution the base
     installation repository will be translated for you. Here's a
     list of commands for a manual upgrade:

       > tar -zxvf OpenInteract-1.06.tar.gz
       > cd OpenInteract-1.06
       > perl Makefile.PL
       > make
       > make test
       > make install
       > oi_manage upgrade --base_dir=/opt/OpenInteract 

     And if you're using CPAN:

       > perl -MCPAN -e shell
       cpan> install OpenInteract::Package
       cpan> exit
       > cd ~/.cpan/build/OpenInteract-1.06
       > oi_manage upgrade --base_dir=/opt/OpenInteract 

     However, after you do this you also need to translate the website
     repositories like this:

       oi_manage upgrade_repository --website_dir=<website-directory>

     If you want to do things the hard way, there's also a script in
     the 'eg/' directory called 'new_package_repository.pl' which will
     translate a package repository from GDBM to the new format.

     3) Any code you've written that operates on packages must be
     redone. Sorry about this, but hopefully not too many people have
     gone scouting around the package repositories in the first place,
     and the benefits outweigh the costs at this relatively early
     stage of OI development.

     Here's a simple example:

     Old: 
        my $pkg = OpenInteract::Package->fetch_by_name( 
                                          { name => 'blah',
                                            directory => '/blah/blah' });

     New:
        my $repository = OpenInteract::PackageRepository->fetch( 
                                          undef, { directory => '/blah/blah });
        my $info = $repository->fetch_package_by_name({ name => 'blah' });

     If you've actually done work with packages and need some help,
     email Chris <chris@cwinters.com> for more detailed guidelines.
    
 * script/oi_manage, OpenInteract/ApacheStartup.pm,
   OpenInteract/Startup.pm, OpenInteract/SQLInstall.pm: Modified
   all functions dealing with packages to work with new system.
 
 * OpenInteract/Package.pm: 

   -- Fixed file handling bug in revised module method
   install_distribution() which checked $_ (empty) rather than
   $p->{package_file}. Thanks to Takanori Ugai <ugai@jp.fujitsu.com>
   for the catch and patch.

   -- Fixed new behavior of remove() which removed the directory in
   addition to the entry from the repository. You can pass in 'remove'
   as the third argument to have it remove the directory, otherwise
   the directory is kept, which was the default behavior before the
   new stuff was written.

   -- Added 'script/' as set of files to be copied over when applying
   a package from the base installation to a website.

 * conf/sample-server.perl: new keys: 

     {session_info}->{expiration} = '+3M',

     (allows you to set a default expiration time for the session
     cookie)

     {system_alias}->{'OpenInteract::PackageRepository'} = 'repository',

     (alias used to reference the repository class)

     {box}->{custom_box_handler} = '',

     (allows you to define a handler to be called on every request to
     create/inspect/modify boxes)

   You'll probably want to copy the items over into your server
   configuration, although this brings up the interesting point as to
   how to insert new configuration options into existing
   websites. Perhaps we need a utility like that used in Win32
   environments with the registry -- you can distribute a simple file
   which is used by oi_manage to insert new keys into a website's
   server.perl file.

 * script/oi_manage:

   -- Modified format to be more readable; added more documentation.

   -- Mdified all calls to 'open_base_config()' to call the routine in
   OpenInteract::Startup

   -- Added checks for 'website_name' in the 'create_website' command,
   since the parameter must refer to a valid Perl package identifier.

   -- Added new action 'upgrade' (just like 'install' but we don't
   create a new directory)

   -- Added new action 'refresh_doc' (allow a website to get the
   latest version of the documentation in the base installation
   directory).

 * OpenInteract/Startup.pm: Modified name of parameter passed into
   'read_base_config()' (shouldn't affect anyone); added
   'create_base_config_filename()' so we have one place to generate
   it.

 * OpenInteract/SPOPS.pm: added the URL to view the object to the
   email sent by notify()

 * doc/admin.html: Cleaned up and added some more information

 * Several packages were also modified, but each of these has its own
   changelog for the specific changes. Many of the changes were quite
   small, including conf/spops.perl modifications to accommodate
   changes in SPOPS key generation (add an 'increment_field => 1' for
   those classes using a MySQL AUTO_INCREMENT field).

   base:           1.20 -> 1.30
   base_box:       0.13 -> 0.14
   base_component: 1.11 -> 1.14
   base_error:     1.13 -> 1.14
   base_group:     1.10 -> 1.11
   base_security:  1.18 -> 1.20
   base_template:  1.09 -> 1.11
   base_theme:     1.09 -> 1.11
   base_user:      1.14 -> 1.15
   static_page:    1.21 -> 1.24
   classified:     1.07 -> 1.12
   full_text:      1.09 -> 1.11
   news:           1.13 -> 1.15


1.05  Thu Feb  1 00:26:14 EST 2001

  Added 'setup_static_environment' to OpenInteract/Startup.pm -- this
  makes it *incredibly* easy to setup an OI environment outside of
  Apache/CGI/Web-whatever, allowing you to do data reporting, import,
  export, etc. 

  Refactored (not 100%, but still pretty well) OpenInteract/Package.pm
  to be easier to understand, including breaking up longer 'meaty'
  subroutines into easier-to-digest versions. Added lots of POD
  documentation as well.

  Added website installation message to 'oi_manage' and modified it to
  display an 'INSTALL' file whenever the package is installed to a
  website (either via 'upgrade' or 'apply'). This means that package
  authors can alert users to potential schema change or other API
  modifications and be sure that users will see this when the package
  is applied/upgraded -- minimize potential user excuses :-)

  The basic OpenInteract documentation (included with the Perl
  distributed in 'doc/') is now copied over to the OpenInteract base
  installation directory (when you do 'oi_manage install') and is
  copied from there to a website's HTML directory when you create a
  new one. This means that the HTML OI documentation is available when
  you first fire up your browser to see your website.

  Lots of modifications to many packages, including the addition of a
  new package to the core OpenInteract family: base_box. Let's give
  him a big hand!

1.04  Thu Dec 21 01:01:14 EST 2000

  Modified OpenInteract/Package.pm to accommodate earlier versions of
  Archive::Tar, which had very different interfaces. Added some more
  items to the PREREQ piece of Makefile.PL and scrapped the
  'INSTALLSCRIPT' option to let MakeMaker put the bin files in the
  "right" place. 

  **NOTE -- this means you should remove all older versions of
  'oi_manage' that might be someplace like '/usr/local/bin'**

  We now require version 2.00 of the Template Toolkit. Version 1.06+
  might still work, but it's no longer actively supported.

  Modified scripts/oi_manage to implement a 'list_actions' command,
  which reads in all your website action.perl files and then tells you
  all the actions programmed in the system and which package the
  action comes from.

  Many changes to various packages -- see the changelogs for
  'base', 'base_security', 'base_theme', 'static_page' and several
  others.

1.03  Nov 30 2000

  Added some modifications to when you install OpenInteract and when
  you create a new package (OpenInteract/Package.pm;
  script/oi_manage). Modified documentation in the Developer and Admin
  guides as well as the two INSTALL documents; got that bulky .GIF out
  of the distribution, replacing it with a slightly lame Visio
  drawing (to PNG).

  Relatively minor fixes to the packages news, base_error, base and
  system_doc. See their 'Changes' files for more info.

  Modified scripts/oi_manage to have the same semantics for
  'check_package' as for 'export_package' -- that is, you can chdir to
  the working directory for a package and run the command without any
  parameters and have a check properly performed.

  (minor) Superficial change in just about every file to modify email
  'cwinters@intes.net' to 'chris@cwinters.com'. Also changed all RCS
  '$Header' tags to '$Id'.

1.02  Nov 10 2000

  Package management and oi_manage routines are pretty much rock-solid
  as done from informal testing. We've made new installs and websites
  by the handful and everything has gone well. Added lots of overall
  documentation (in the 'doc/' directory) including targeted guides
  for managers, administrators and developers, plus a glossary, all in
  HTML format. Eliminated a pretty evil bug in the
  'OpenInteract/Template.pm' file of the 'base' package which only
  manifested itself when running more than one website. SQL
  installation has also been smoothed out and tested in numerous
  ways. Lots of other little changes (structure, format, etc.).

  Also made some changes to terminology and enforced it throughout. A
  'base installation' is where you first install OpenInteract (using
  'oi_manage') and a 'server' is the Apache/mod_perl process. A
  'website' is a particular instantiation of OpenInteract with its own
  packages, namespace, etc. The definition for 'package' hasn't really
  changed, but we've made a package kindasorta synonymous with 'tool',
  even though a package can contain more than one tool. 

1.01  Nov 3 2000

  Lots of new things -- massively overhauled package management
  (oi_manage and OpenInteract::Package) including scads of
  documentation and the functions for package removal and upgrade
  capabilities, you can check a package, get a listing of packages
  installed to an application or to the base installation, and can now
  create a 'skeleton' package, which should help out a little bit with
  development; more documentation in the packages distributed with the
  system. You can also add or dump a package's templates, test a
  database connection given the configuration parameters for an
  application, and (more below) install the SQL structures and data
  for a package.

  Added the class 'OpenInteract::DBI' which gives us a central
  location for connecting to a database. Also modified how the
  configuration file is setup wrt database info.

  All 'module.perl' files will hereafter be known as 'action.perl' --
  this is so we can better communicate the concept of the 'Action
  Table' and what it means when you're developing packages and
  applications.

  Added lots of configuration documentation -- see all the files in
  'conf/'. The 'spops.perl' and 'action.perl' files are now
  well-documented and OpenInteract::Package was modified to copy these
  sample files into a new package when a skeleton is created.

  Also modified the 'full_text' scripts for doing certain actions from
  the command-line -- these are good scripts to review if you want to
  create an OpenInteract 'environment' (all the classes created and
  linked, database handle and config object created, etc.) from a
  script rather than from mod_perl.

  Added 'OpenInteract::SQLInstall' and modified all of the packages to
  use its methods as well as translated their incoming structures and
  data to its format. (This was much more work than it sounds like :)

  Numerous other small-to-medium fixes here and there.

1.00  Sep 28 2000

  First public version. Everything is new!